<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="KeyWords" content="Python,Tips,Tipps,Tricks,Guido,Rossum,script,scripts,sripting,language">
   <meta name="Author" content="Hauke Lubenow">
   <title>Python Page #2: Tips and Tricks</title>
</head>
<body>
<H2>
<img SRC="icopy.png" height=32 width=32>&nbsp;
Python Page #2: Tips and Tricks</H2>
<p>
<hr width="70%">
<p>
<b><font face="Times New Roman,Times"><font size=-1>There's strictly no warranty for the correctness of this text. You use any of the information provided here at your own risk.</font></font></b>
<hr width="70%">
<P>
<h3>Contents:</h3>
<OL>
<LI><A HREF="#1">Introduction</A>
<LI><A HREF="#2">File-operations and Filename globbing</A>
<LI><A HREF="#3">Extracting HTML-Tags</A>
<LI><A HREF="#4">Date and Time</A>
<LI><A HREF="#5">Starting other processes from inside a Python-script</A>
<LI><A HREF="#6">Conversions Between Decimal, Hexadecimal, Binary and Octal Numbers</A>
<LI><A HREF="#7">Installing modules</A>
<LI><A HREF="#8">Generating Bytecode of any script</A>
<LI><A HREF="#9">Encrypting and Decrypting Text Using a Password</A>
<LI><A HREF="#10">Scripting LibreOffice.org</A>
<LI><A HREF="#11">Plotting to the screen with Pygame</A>
<LI><A HREF="#12">Messageboxes with tkinter</A>
<LI><A HREF="#13">Parse configuration-files using module "ConfigParser"</A>
<LI><A HREF="#14">PDF and Python</A>
<LI><A HREF="#15">Sending Emails</A>
<LI><A HREF="#16">Receiving Emails from a POP3-Server</A>
<LI><A HREF="#17">Setting up a small html-Server</A>
<LI><A HREF="#18">Creating Windows ".exe"-Files From Python Scripts</A>
<LI><A HREF="#19">Encodings</A>
</OL>
<P>
<HR>
<h3><A NAME="1">1. Introduction</A></h3>
<p>This page describes some things that can be done with Python.
<br>In 2025, the page has been updated to work with Python 3. During the process, a few chapters were taken out.
<P>
<HR>
<h3><A NAME="2">2. File-operations and Filename globbing</A></h3>
<p>This script demonstrates some often-used file-operations:
<pre>#!/usr/bin/python
# coding: utf-8

import os
import sys

import glob

# Get current working directory:
mypath = os.getcwd()

myfile = os.path.join(mypath, "myfile.txt")

# Test, if file exists:
if os.path.exists(myfile):
    print("File already exists.")
    sys.exit(1)

fh = open(myfile, "w")

fh.write("This is a line of text.\n")
fh.write("This is another line.\n")

fh.close()

fh = open(myfile, "r")

a = fh.readlines()

fh.close()

for i in a:
    print(i.rstrip("\n"))

# os.remove(myfile)

print("The directory contains:")
b = os.listdir(mypath)
for i in b:
    print(i)

# Filename globbing:
print()
print("The directory contains the following html-files:")
b = glob.glob("*html")
if b:
    for i in b:
        print(i)
else:
    print("None.")</pre>
<p>For copying and moving files and directories and for deleting directories recursively, it is recommended to use the module "<tt>shutil</tt>".
<P>
<HR>
<h3><A NAME="3">3. Extracting HTML-Tags</A></h3>
<p>If you want to extract html-tags from a html-file, there's a problem with greed. You should then use a regular expressions with its last character as a negated character-class:
<pre>#!/usr/bin/python
# coding: utf-8

import re

html = """&lt;html&gt;
&lt;body&gt;
&lt;h2&gt;Caption 1&lt;/h2&gt;
&lt;p&gt;Some text.
&lt;h2&gt;Caption 2&lt;/h2&gt;
&lt;p&gt;Some more text.
&lt;br&gt;Going on.
&lt;/body&gt;
&lt;/html&gt;"""

html = html.split("\n")

patobj = re.compile("&lt;h2&gt;([^&gt;]*)&lt;\/h2&gt;") # Notice the regexp here.
for line in html:
    line = line.rstrip("\n")
    matchobj = patobj.search(line)
    if matchobj:
        print(matchobj.groups()[0])</pre>
<p>The expression "<tt>&lt;h2&gt;([^&gt;]*)&lt;\/h2&gt;</tt>" means:
<p>'Find "<tt>&lt;h2&gt;</tt>", then any amount of characters, that aren't "<tt>&gt;</tt>" (and mark them for extraction), then "<tt>&lt;/h2&gt;</tt>".
<p>The <a href="https://docs.python.org/3/library/re.html">Tutorial</a> says, you can also use "<tt>?</tt>" for marking an expression as being "not greedy" but the way above should be even more reliable.
<p>The best practice to extract text from a HTML-page in Python, would be using the module "<a href="https://pypi.org/project/beautifulsoup4/">Beautiful Soup</a>".
<P>
<HR>
<h3><A NAME="4">4. Date and Time</A></h3>
<p>This script demonstrates some often-used operations concerning date and time (using the a little low-level <tt>time</tt>-module):
<pre>#!/usr/bin/python
# coding: utf-8

import time

# Print current time in central European format including seconds:
print(time.strftime("%H:%M:%S"))

# On Linux, you can read more about format-strings like "%H:%M:%S"
# by executing the shell-command "info date".

# Print today's date in central European format; the numbers of days and months
# below 10 are zero-padded (like in 09.08.2007):
print(time.strftime("%d.%m.%Y"))

# Print seconds since epoch (on Linux, epoch is 1.1.1970):
print(time.time())

# Generate a time-tuple from seconds since epoch and print(it:)
tmtp = time.localtime(time.time())
print(tmtp)

# Print today's date in central European format using the time-tuple generated above;
# the numbers of days and months below 10 are blank-padded (like in 9.8.2007):
print(str(tmtp[2]) + "." + str(tmtp[1]) + "." + str(tmtp[0]))

# Convert the time-tuple back to seconds since epoch:
print(time.mktime(tmtp))
</pre>
<HR width=50%>
<p>If you want to calculate the time or the number of days between two or more dates, the <tt>datetime</tt>-module is even more useful:
<pre>#!/usr/bin/python
# coding: utf-8

import datetime

# Generate a datetime.date-object for today:
d1 = datetime.date.today()
print(d1.strftime("%d.%m.%Y"))

# Generate a datetime.date-object for "30.01.2010":
d2 = datetime.date(2010, 1, 30)

# Now we can do some calculations with a datetime.timedelta-object:
td = d1 - d2
a = "Today is "
if d1 > d2:
    a += str(td.days) + " days after "
else:
    a += str(td.days * -1) + " days before "
a += d2.isoformat() + "."
print(a)

try:
    feb29 = datetime.date(d1.year, 2, 29)
    print("This year is a leap year.")
except ValueError:
    print("This year is not a leap year.")
</pre>
<P>
<HR>
<h3><A NAME="5">5. Starting other processes from inside a Python-script</A></h3>
<p>You can start other processes like that:
<pre>
#!/usr/bin/python
# coding: utf-8

import os

os.system("ls")
</pre>
<p>If you want to grab the process' output, you can do:
<pre>
#!/usr/bin/python
# coding: utf-8

import os

ph = os.popen("ls")
a = ph.readlines()
ph.close()

print(a)
</pre>
<p>If you want to have more control over the started process, for example have it running for some time and pass commands to it while it's running, you should take a look at the Python-module
<pre>subprocess</pre>
<hr width=30%>
<p>On Microsoft Windows the command
<pre>os.startfile("somefile.html")</pre>
<p>is very useful: It starts a file with its connected application (like clicking on its icon in "Explorer").
<br>So in the example above, the system's default-browser is started showing "<tt>somefile.html</tt>".
<br>That way, you don't have to worry about the application's correct start-command. Very nice.
<P>
<HR>
<h3><A NAME="6">6. Conversions Between Decimal, Hexadecimal, Binary and Octal Numbers</A></h3>
<P>The following script shows, how these number-conversions can be done:
<pre>#!/usr/bin/python
# coding: utf-8

hexnum = "FF";
decnum = 255;
binnum = "11111111";
octnum = "377";

# Hexadecimal to decimal:
print(int(hexnum, 16))

# Hexadecimal numbers start with "0x":
print(0xFF)

# Decimal to hexadecimal:
print(hex(decnum))
print("%X" % decnum)

# Binary to decimal:
print(int(binnum, 2))

# Decimal to binary:
print("{0:08b}".format(decnum))

# Octal to decimal:
print(int(octnum, 8))

# Octal numbers start with "0".
# They are used for example in functions like os.chmod().
print(0o377)

# Decimal to octal:
print(oct(decnum))
print("%o" % decnum)</pre>
<p>Notice, that the functions <tt>hex()</tt> and <tt>oct()</tt> return a string.
<p>It seems, in earlier Python version (Python 2.4 and such) there wasn't built-in support for decimal-to-binary-conversion. A function "posdec2bin()" could have been used instead:
<pre>def posdec2bin(decnum):

    hexbin = {"0":"0000", "1":"0001", "2":"0010", "3":"0011",
              "4":"0100", "5":"0101", "6":"0110", "7":"0111",
              "8":"1000", "9":"1001", "A":"1010", "B":"1011",
              "C":"1100", "D":"1101", "E":"1110", "F":"1111"}

    hexnum = hex(decnum)[2:]
    hexnum = hexnum.upper()

    binlist = []

    for i in hexnum:
        binlist.append(hexbin[i])

    binstring = "".join(binlist)
    binstring = binstring.lstrip("0")
    return binstring</pre>
<p>
<HR>
<h3><A NAME="7">7. Installing modules</A></h3>
<p>Modules often come with a "setup.py"-file. Usually, it should be run as root with
<pre>python setup.py install</pre>
<p>Help on more commands "setup.py" knows, can be found doing
<pre>python setup.py --help-commands</pre>
<P>
<HR>
<h3><A NAME="8">8. Generating Bytecode of any script</A></h3>
<p>When you execute a Python-script, bytecode is generated. Sometimes it is saved as a .pyc-files. These files can be executed by Python just like .py-files. They start a little faster too, but don't run faster. They don't contain plain-text, so they can't be viewed in an editor directly, but they can be retransformed to .py-files by using something like <a href="http://www.crazy-compilers.com/decompyle/">this</a>.
<br>However, if you want to generate a .pyc-file for a certain .py-file, you can use the script "compileall.py", that comes with your Python-distribution.
<P>
<HR>
<h3><A NAME="9">9. Encrypting and Decrypting Text Using a Password</A></h3>
<p>In this chapter used to be some Python-code that encrypted some text with the "pycrypto"-module and some other old crypto-module. As that module is deprecated by now, this code doesn't work any more.
The encryption/decryption can be done on Linux with shell-command "gpg" though (provided, it is installed on the system).
<br>Sometimes it makes sense to write the data processing in Python, and finally call shell-commands with "<tt>os.system()</tt>":
<pre>#!/usr/bin/python
# coding: utf-8

import os, sys

def askAndDelete(fname):
    c = input("Do you want to delete file '" + fname + "'? (y/n) ")
    if c == "y":
        os.remove(fname)
    else:
        print("Didn't remove file '" + fname + "'. Bye.")
        sys.exit()

a = ("unencrypted.txt", "encrypted.txt", "decrypted.txt")
s = "For your eyes only!"

for i in a:
    fname = os.path.join(os.getcwd(), i)
    if os.path.exists(fname):
        askAndDelete(fname)

print("Writing string '" + s + "' to file 'unencrypted.txt'.\n")
fh = open("unencrypted.txt", "w")
fh.write(s + "\n")
fh.close()

print("Encrypting to newly created file 'encrypted.txt' using password \"Melina\".\n")
e = """echo 'Melina' | gpg --batch --textmode --passphrase-fd 0 -o encrypted.txt -c unencrypted.txt"""
os.system(e)

print("Decrypting to newly created file 'decrypted.txt' using password \"Melina\".\n")
e = """echo 'Melina' | gpg --batch --textmode --passphrase-fd 0 -d encrypted.txt > decrypted.txt"""
os.system(e)</pre>
<P>
<HR>
<h3><A NAME="10">10. Scripting LibreOffice.org</A></h3>
<p>You can use Python as a scripting language for <a href="http://www.LibreOffice.org">LibreOffice</a>. To be able to do that, you have to do two things first:
<p>1. There's a Python-module called "uno.py" that needs to be imported in the Python-script. "uno.py" comes with LibreOffice. It should be in its "program"-directory. You have to make sure, that it can be found by Python.
This can be done by putting a file "uno.pth" into the python-path, for example to "/usr/lib/python/site-packages". The file "uno.pth" needs to contain just the path to the LibreOffice-"program"-directory, for example
<pre>/usr/lib/libreoffice/program</pre>
<p>2. To accept python-scripting, LibreOffice needs to be activated in a special server-mode. This is done by starting it with
<pre>oowriter --accept="socket,host=localhost,port=2002;urp;"</pre>
<p>If it's started this way, it accepts scripting from a script like this:
<pre>#!/usr/bin/python

import uno
from com.sun.star.text.ControlCharacter import PARAGRAPH_BREAK

# Initializing:
local = uno.getComponentContext()
resolver = local.ServiceManager.createInstanceWithContext ("com.sun.star.bridge.UnoUrlResolver", local)
context = resolver.resolve ("uno:socket,host=localhost,port=2002;urp;StarOffice.ComponentContext")
desktop = context.ServiceManager.createInstanceWithContext ("com.sun.star.frame.Desktop", context)

# Creating a new document:
document = desktop.loadComponentFromURL( "private:factory/swriter", "_blank", 0, () )

# This would write into the current document instead, if one was already loaded:
# document = desktop.getCurrentComponent()

cursor = document.Text.createTextCursor()

document.Text.insertString(cursor, "Hellow", 0)

# Doing a "Backspace" deleting the "w" from "Hellow":
cursor.goLeft(1,1)
cursor.setString("")

# Insert a "Return":
document.Text.insertControlCharacter(cursor, PARAGRAPH_BREAK,0)

document.Text.insertString(cursor, "Hello from Python.", 0)

"""
Other things (this part is currently not executed):

Loading a new document would be:
document = desktop.loadComponentFromURL("file:///home/user/letter.odt", "_blank", 0, () )
cursor = document.Text.createTextCursor()

Going to an already existing Bookmark named "bmark" would be:
Bookmark = document.Bookmarks.getByName(bmark)
cursor = document.Text.createTextCursorByRange(Bookmark.Anchor)

Inserting into an already existing TextFrame called "name" would be:
frames=document.getTextFrames()
frame=frames.getByName(name)
cursor = frame.Text.createTextCursor()
frame.Text.insertString(cursor, "Hello.", 0)
"""
</pre>
<P>
<HR>
<h3><A NAME="11">11. Plotting to the screen with Pygame</A></h3>
<p>The <a href="http://www.pygame.org/">Pygame</a>-modules provide Python-access to "SDL", a multimedia-library similar to "DirectX" on Windows. 
<br>Pygame provides a window in which you can draw graphical objects, move them around and remove them again. It also provides modules for processing keyboard- and mouse-events and for playing several sounds and additionally music at the same time.
<br>So you can use Pygame to program 2D-games. As this is a subject of its own, I have another webpage about it.
<br>Some years ago, I had to do
<pre>export SDL_AUDIODRIVER=alsa</pre>
<p>to get sound working correctly with my soundcard before starting a Pygame-application. Today, this may not be necessary any more.
<p>Pygame's capabilities can also be used for other purposes than game-programming. Here is a script, that calculates some mathematical object and plots it to the screen.
<br>As an exception, in this script the picture is plotted only once.
But in games, it would be necessary to clear and redraw the screen each "frame", that is each time the program is going through the main-loop.
<br>Press "q" to quit it:
<pre>#!/usr/bin/python
# coding: utf-8

import pygame

import os
import math

RESX = 800
RESY = 600

def drawGauss(surface):
    b = 0.3
    ULIM = 100.
    UDIV = 1.8

    for u in range(0, int(ULIM), 1):
        # Some mathematical, Gaussian calculations:
        a = float(u) / (ULIM / UDIV)
        if u > ULIM / 2:
            a = UDIV - (float(u) / (ULIM / UDIV))
        m = u / 16.

        for x in range(50, RESX - 50):
            c = x / (RESX / 16.) - 5.
            y = a * math.exp(-b * (c - m) * (c - m))

            # down:
            y = RESY / 10 + (y * RESY / 1.5 + u * 3)

            # up:
            # y = RESY * 9 / 10 - (y * RESY / 1.5 + u * 3)

            pygame.draw.line(surface, (200,200,200), (x, y), (x, y), 1)

def processEvents():
    pygame.event.pump()
    pressed = pygame.key.get_pressed()
    if pressed[pygame.K_q]:
        return "quit"
    return 0

# Main:

os.environ['SDL_VIDEO_WINDOW_POS'] = "245, 40"
screen = pygame.display.set_mode((RESX, RESY))
pygame.display.set_caption('Gauss') 
pygame.init()
drawGauss(screen)
clock = pygame.time.Clock()
running = True
# Main loop:
while running:
    clock.tick(60)

    # We're not clearing all sprites and rebuilding the screen this time:
    # screen.fill(BLACK)

    if processEvents() == "quit":
        running = False
        pygame.quit()

    if running:
        pygame.display.flip()</pre>
<P>
<HR>
<h3><A NAME="12">12. Messageboxes with tkinter</A></h3>
<p>tkinter is one of the GUI-toolkits available for Python. With it, you can create window-applications.
<br>Actually tkinter is an interface to Tk, the GUI-toolkit of the language "Tcl", but usually you won't notice that.
<br>tkinter is quite small in relation to other GUI-toolkits. Its windows don't look too beautiful, but they are usable.
<p>The following script "msgbox.py" provides a simple messagebox in tkinter:
<pre>#!/usr/bin/python
# coding: utf-8

# msgbox.py

import os
import tkinter as tk

class MyMsgBox:

    def __init__(self, title = "My Title", msg = "Some text"): 
        if os.name == "nt":
            self.appfont = "{Arial} 10 {normal}"
        elif os.name == "posix":
            self.appfont = "{suse sans} 15 {normal}"
        else:
            self.appfont = "{suse sans} 15 {normal}"
        self.mw = tk.Tk()
        self.mw.title(title)
        # self.mw.iconname(iconname)
        self.mw.geometry("+350+300")
        self.mw.option_add("*font", self.appfont)
        self.label = tk.Label(self.mw, text = msg)
        self.label.pack(side = tk.TOP, anchor = tk.W, padx = 50, pady = 10)

        self.btn_exit = tk.Button(self.mw, text = "Ok", command = self.mw.destroy)
        self.btn_exit.focus()
        self.btn_exit.bind('&lt;Return&gt;', self.mwDestroy)
        self.btn_exit.pack(side = tk.RIGHT, anchor = tk.E, padx = 20, pady = 15)
        self.mw.mainloop()

    def mwDestroy(self, a):
        self.mw.destroy()

if __name__ == "__main__":
   app = MyMsgBox("Hello", "Some text.")
</pre>
<p>You can run "msgbox.py" directly, but in general it is meant to be used as a module that is called from another script:
<pre>#!/usr/bin/python
# coding: utf-8

from msgbox import MyMsgBox

msgb = MyMsgBox("Window", "Hello from the controlling script.")</pre>
<p>If you have already an opened Toplevel-tkinter-window, you can even do this instead:
<pre>#!/usr/bin/python
# coding: utf-8

import tkinter.messagebox

tkinter.messagebox.showinfo(title = "Hello",
                            message = "Some text")</pre>
<P>
<HR>
<h3><A NAME="13">13. Parse configuration-files using module "ConfigParser"</A></h3>
<p>With Python you can parse configuration-files using the module "ConfigParser", which is part of the Python-distribution.
<br>The configuration-files have to be in a standard-format: They must have sections, followed by options and values in a format like this:
<pre>[section]
option=value
option=value
</pre>
Take for example the configuration-file for the KDE-editor "kate" called "katerc". If "kate" is installed, it can be found here:
<pre>/home/user/.kde/share/config/katerc</pre>
<p>If your "katerc" looks like this:
<pre>[$Version]
update_info=kate-2.4.upd:kate2.4

[Filelist]
Edit Shade=255,102,153
Shading Enabled=true
Sort Type=0
View Shade=51,204,255

[General]
Days Meta Infos=30
Modified Notification=false
</pre>
<p>you can use the following Python-script in its directory to parse it:
<pre>#!/usr/bin/python
# coding: utf-8

import configparser

c = configparser.ConfigParser()

# Read in the configuration in file "katerc":
c.read("katerc")

secs = c.sections()

print()
print("These are all sections, options and values:")
print()

for i in secs:
    print(i)
    opts = c.options(i)
    for u in opts:
        value = c.get(i, u)
        print("\t" + u + "\t\t\t" + value)
print()

# Setting all values to "MyValue":
for i in secs:
    opts = c.options(i)
    for u in opts:
        c.set(i, u, "MyValue")

# Uncommenting the following lines would write the configuration
# stored in object "c" to a file "out.conf":
#
# fh = open("out.conf", "w")
# c.write(fh)
# fh.close()
# print("New configuration written to file 'out.conf'." )
</pre>
<p>Please see "pydoc3 configparser" for further information.
<P>
<HR>
<h3><A NAME="14">14. PDF and Python</A></h3>
<p>For creating new PDFs using Python, I suggest taking a look at the open-source-version of the "<a href="https://docs.reportlab.com">ReportLab PDF Toolkit</a>" module-library.
<p>For postprocessing already existing PDFs, on Linux I'd use the console-tool "pdftk". For Python, there's also "pyPdf".
<P>
<HR>
<h3><A NAME="15">15. Sending Emails</A></h3>
<p>Python comes with everything that is needed to establish an email-client without the help of other programs. Modules included are "smtplib" and "email".
<p>Sending emails is very easy with the script <a href="https://github.com/gerold-penz/python-simplemail">simplemail</a>. On its page is an example, how to use it. It's for Python 2.x, so the module may need a bit of adaption.
<P>
<HR>
<h3><A NAME="16">16. Receiving Emails from a POP3-Server</A></h3>
<p>Email's data-format was originally meant for transmitting just plain text.
So all data, even of attachments like .jpg- or .mp3-files, is encoded and put together into a single text-message.
Such a message has headers beginning with "To:" or "Date:", followed by the email's text and so on.
<br>So after receiving an email-message from a server, you have to parse it into the parts you're interested in.
You can do this with the module "email.message".
<p>The following script accesses a POP3-email-server "pop3.exampleserver.com", fetches all emails for user "user@exampleserver.com" there using password "examplepassword" and stores all email-parts including attachments in a handy Python-list. The script just prints this list, but of course you can do much more interesting things with it like for example extract only the messages' texts or save the attachments.
<br>As you can see, element four of the list is the attachment stored as another list with just two elements, the attachment-filename and the attachment-data. The later can be saved using "<i>fp = open(filename, "wb")</i>" and proceeding as described above in "File-operations":
<pre>#!/usr/bin/python
# coding: utf-8

import sys
import poplib
import email
from email import message 

HOST = "pop3.exampleserver.com"
PORT = "995"
USER = "user@exampleserver.com"
PASSWORD = "examplepassword"

def getAllEmails(host, port, user, passw): 

    try:
        M = poplib.POP3_SSL(host, port)
    except:
        print("Error: Email-server not found.")
        sys.exit(1)

    try:
        M.user(user) 
        M.pass_(passw)
    except:
        print("Error loging in: Maybe invalid username or password.")
        sys.exit(2)
    
    emails = [] 
         
    maillist = M.list()[1]

    if len(maillist) > 0: 

        for mailnr in range(len(maillist)):

            adress = "" 
            subject = "" 
            content = "" 
            attachment = [] 

            textbyteslist = M.retr(mailnr + 1)[1]
            temp = []
            for i in textbyteslist:
                temp.append(i.decode("utf-8")) 

            m = email.message_from_string("\n".join(temp))

            types = m.items() 
                 
            for a in types:

                if a[0] == "From": 
                    adress = a[1] 

                if a[0] == "Subject":
                    subject = a[1]
                                 
            for part in m.walk(): 

                if part.get_content_maintype() == 'multipart': 
                    continue 
 
                if part.get_content_maintype() == "text":
                    content = part.get_payload(decode = True)
                         
                if  part.get_filename() is not None: 
                    attachment.append([part.get_filename(), part.get_payload(decode = True)]) 
                 
            emails.append([mailnr + 1, adress, subject, content, attachment]) 

    M.quit() 

    return emails

a = getAllEmails(HOST, PORT, USER, PASSWORD)
print(a)
</pre> 
<p>It is also possible to delete emails directly on the distant server using "<i>poplib.dele()</i>".
<P>
<HR>
<h3><A NAME="17">17. Setting up a small html-Server</A></h3>
<p>It's amazing, that it's possible to set up a small html-server with just a few lines of Python-code:
<pre>#!/usr/bin/python
# coding: utf-8

# httpd.py

import sys

from http.server import HTTPServer
from http.server import CGIHTTPRequestHandler

serveradresse = ("", 8080)
server = HTTPServer(serveradresse, CGIHTTPRequestHandler)

try:
    print
    print("Serving:")
    print("Please open a browser and point it to \"http://localhost:8080/test.html\"")
    print("Press \"CTRL+c\" to exit.")
    server.serve_forever()

except KeyboardInterrupt:
    print("Bye.")
    sys.exit()
</pre>
<p>It can manage .html-files found in and below its directory.
<br>For example, you can put a file "test.html" there and access it with an internet-browser pointing to "http://localhost:8080/test.html".
<br>If you just go to "http://localhost:8080/", the server tries to show you a page "index.html" in its directory.
<br>You can also use the server to test your CGI-scripts.
<p>I wouldn't take this small server to the internet, as there may be security risks. For internet purposes, I suggest using a larger server like "<a href="http://en.wikipedia.org/wiki/Apache_HTTP_Server">Apache</a>".
<P>
<HR>
<h3><A NAME="18">18. Creating Windows ".exe"-Files From Python Scripts</A></h3>
<p>Especially on Windows, many users seem to be reluctant to install the Python interpreter. They are used to computer programs coming as Windows executables, that is as "<tt>.exe</tt>"-files. Not as scripts with the file extensions "<tt>.py</tt>" or "<tt>.pyw</tt>", that look unfamiliar to them.
<br>However, it is possible, to pack the parts of the Python interpreter and all the modules needed by a script to run, into a single "<tt>.exe</tt>"-file. That way, the script can also be handed out to users, that couldn't cope with installing the Python interpreter or even additional modules.
<p>A program to create such a Windows executable is <a href="https://pyinstaller.org">PyInstaller</a>. To turn a GUI-script into a single "<tt>.exe</tt>"-file, it would be run like this:
<pre>pyinstaller --onefile --windowed yourscript.pyw</pre>
<p>More options of PyInstaller can be found <a href="https://pyinstaller.org/en/stable/usage.html#options">here</a>.
<p>Another way to create such an "<tt>.exe</tt>"-file would be <a href="https://www.py2exe.org">py2exe</a>. As it's an extension to the "<tt>distutils</tt>"-package, it has to be used a bit differently.
<br>First, a file called "<tt>setup.py</tt>" has to be created, which holds all the options and points to your Python script. "<tt>setup.py</tt>" may look like this:
<pre># setup.py
from distutils.core import setup
import py2exe, sys, os

sys.argv.append('py2exe')

setup(
    options = {'py2exe': {'bundle_files': 1, 'compressed': True}},
    windows = [{'script': "yourscript.pyw"}],
    zipfile = None,
)</pre>
<p>Then, this command is run to create the "<tt>.exe</tt>"-file:
<pre>python setup.py py2exe</pre>
<p>By default (with a simpler "<tt>setup.py</tt>"-file) py2exe creates a large directory with a much smaller "<tt>.exe</tt>"-file and all the library-files needed to run it.
<p>More options of py2exe's "<tt>setup.py</tt>"-file can be found <a href="https://www.py2exe.org/index.cgi/ListOfOptions">here</a>.
<P>
<HR>
<h3><A NAME="19">19. Encodings</A></h3>
<P>The encoding-line at the beginning of a script tells the script, which encoding the script uses:
<pre># coding: utf-8</pre>
<p>for <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> or 
<pre># coding: iso-8859-1</pre>
<p>for <a href="https://en.wikipedia.org/wiki/ISO-8859-1">ISO-8859-1</a> (= Latin 1).
<p>Sometimes, there can be problems with encodings, when you try to ouput text, either to the console or to GUIs (like tkinter). I suggest, experimenting with "str.encode()" then. At least, this works on my system:
<pre>#!/usr/bin/python
# coding: utf-8

a = "Zw&ouml;lf Boxk&auml;mpfer jagen Eva quer &uuml;ber den gro&szlig;en Sylter Deich."
print(a)</pre>
<p>On Linux, the result depends on the system locales, printed by the "locale"-command, like for example "$LANG". "$XTERM_LOCALE" may be another variable to look for.
<hr width="70%">
<br><center><a href="index.html">Back</a></center>
<br>Author: hlubenow2 {at-symbol} gmx.net
</body>
</html>
